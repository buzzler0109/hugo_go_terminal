<div id="password-modal" class="password-modal">
    <div class="password-modal-content">
        <div class="password-modal-header">
            <h3>Приватний розділ</h3>
            <button class="password-modal-close" onclick="closePasswordModal()">&times;</button>
        </div>
        <div class="password-modal-body">
            <p>Для доступу до приватного розділу введіть пароль:</p>
            <div class="password-input-container">
                <input type="password" id="password-input" placeholder="Введіть пароль" />
                <button id="password-submit" class="main-btn">Увійти</button>
            </div>
            <div id="password-error" class="password-error" style="display: none;">
                Неправильний пароль. Спробуйте ще раз.
            </div>
        </div>
    </div>
</div>

<script>
let isAuthenticated = false;
const STORAGE_KEY = 'shum_private_access';

// Проверяем авторизацию при загрузке страницы
document.addEventListener('DOMContentLoaded', function() {
    checkAuthentication();
});

// Проверка авторизации
function checkAuthentication() {
    const auth = localStorage.getItem(STORAGE_KEY);
    if (auth === 'true') {
        isAuthenticated = true;
        showPrivateContent();
    } else {
        hidePrivateContent();
    }
}

// Показать модальное окно
function showPasswordModal() {
    document.getElementById('password-modal').style.display = 'flex';
    document.getElementById('password-input').focus();
}

// Закрыть модальное окно
function closePasswordModal() {
    document.getElementById('password-modal').style.display = 'none';
    document.getElementById('password-input').value = '';
    document.getElementById('password-error').style.display = 'none';
}

// Обработка ввода пароля
document.getElementById('password-submit').addEventListener('click', function() {
    const password = document.getElementById('password-input').value;
    const correctPassword = '{{ .Site.Params.privatePassword }}';
    
    if (password === correctPassword) {
        isAuthenticated = true;
        localStorage.setItem(STORAGE_KEY, 'true');
        closePasswordModal();
        showPrivateContent();
        // Редирект на приватную страницу, если мы на ней
        if (window.location.pathname.includes('/private/')) {
            window.location.reload();
        } else {
            window.location.href = '/ua/private/';
        }
    } else {
        document.getElementById('password-error').style.display = 'block';
        document.getElementById('password-input').value = '';
        document.getElementById('password-input').focus();
    }
});

// Обработка Enter в поле пароля
document.getElementById('password-input').addEventListener('keypress', function(e) {
    if (e.key === 'Enter') {
        document.getElementById('password-submit').click();
    }
});

// Выход из приватного режима
function logoutPrivate() {
    isAuthenticated = false;
    localStorage.removeItem(STORAGE_KEY);
    hidePrivateContent();
    if (window.location.pathname.includes('/private/')) {
        window.location.href = '/ua/';
    }
}

// Показать приватный контент
function showPrivateContent() {
    const privateElements = document.querySelectorAll('.private-content');
    privateElements.forEach(el => {
        el.style.display = 'block';
    });
    
    const loginButtons = document.querySelectorAll('.private-login-btn');
    loginButtons.forEach(btn => {
        btn.style.display = 'none';
    });
}

// Скрыть приватный контент
function hidePrivateContent() {
    const privateElements = document.querySelectorAll('.private-content');
    privateElements.forEach(el => {
        el.style.display = 'none';
    });
    
    const loginButtons = document.querySelectorAll('.private-login-btn');
    loginButtons.forEach(btn => {
        btn.style.display = 'flex';
    });
}

// Глобальные функции для использования в шаблонах
window.showPasswordModal = showPasswordModal;
window.logoutPrivate = logoutPrivate;
</script> 